import { type NextPage } from "next";
import Head from "next/head";
import Link from "next/link";

import { api } from "../../utils/api";
import Navbar from "../../components/Navbar";
import { useState } from "react";

const Restaurant: NextPage = () => {
  const restaurant = api.restaurant.getAll.useQuery();
  const [zipcode, setZipcode] = useState<null | string>(null);
  const restaurants = api.restaurant.getByZipcode.useQuery({
    zipcode: zipcode,
  });

  const updateUsername = api.user.updateUsername.useMutation();
  const handleSearch = (e: React.SyntheticEvent<HTMLFormElement>) => {
    e.preventDefault();
    const form = e.currentTarget;
    const formElements = form.elements as typeof form.elements & {
      zipCode: { value: string };
    };
    setZipcode(formElements.zipCode.value);
  };
  // cityName
  // cuisineType
  // email
  // hoursInterval
  // id
  // latitude
  // longitude
  // phone
  // restaurantName
  // stateName
  // website
  // zipCode

  address: if (restaurants.status === "loading") return <>loading</>;
  if (restaurants.status === "error") return <>error</>;
  if (restaurants.status === "success")
    return (
      <>
        <Head>
          <title>Foodly</title>
          <meta name="description" content="Generated by create-t3-app" />
          <link rel="icon" href="/favicon.ico" />
        </Head>
        <main>
          <Navbar />
          <div className="flex flex-col gap-2">
            <form onSubmit={handleSearch}>
              <label>Zip Code:</label>
              <input
                type="text"
                name="zipCode"
                className="bg-gray-200"
                placeholder="zip code"
              ></input>
              <button type="submit" className="bg-gray-200">
                search now
              </button>
            </form>
            {restaurants.data.map((elem) => {
              // return <Link href={`/restaurant/${elem.id}`} key={elem.id}>{elem.name}</Link>
              return (
                <div key={elem.id} className="flex flex-col">
                  <div>{elem.id}</div>
                  <div>{elem.restaurantName}</div>
                </div>
              );
            })}
          </div>
        </main>
      </>
    );
  else return <></>;
};

export default Restaurant;
